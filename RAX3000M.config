# 基于 OpenWrt 24.10 官方源码，适配 RAX3000M (MT7981)
CONFIG_TARGET_mediatek=y
CONFIG_TARGET_mediatek_filogic=y
CONFIG_TARGET_mediatek_filogic_DEVICE_rakwireless_rax3000m=y

# 基础系统优化
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_DEFAULT_kernel=y
CONFIG_KERNEL_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_KERNEL_PM=y
CONFIG_KERNEL_PM_DEBUG=y

# ========== BBR V3 核心（开机默认启用） ==========
CONFIG_KERNEL_NET_SCH_CODEL=y
CONFIG_KERNEL_NET_SCH_FQ_CODEL=y
CONFIG_KERNEL_NET_SCH_HTB=y
CONFIG_KERNEL_NET_CLS_ACT=y
CONFIG_KERNEL_NET_CLS_U32=y
CONFIG_KERNEL_NET_ACT_MIRRED=y
CONFIG_KERNEL_NET_ACT_IPT=y
CONFIG_KERNEL_TCP_CONG_BBR=y
CONFIG_KERNEL_TCP_CONG_BBR3=y
CONFIG_KERNEL_DEFAULT_TCP_CONG="bbr3"  # 内核层默认 BBR V3
CONFIG_PACKAGE_kmod-tcp-bbr=y
CONFIG_PACKAGE_iproute2-tc=y  # 网络调优工具

# ========== 全量网络加速配置（新增） ==========
# 1. 硬件转发/加速
CONFIG_KERNEL_NET_NF_CONNTRACK_EVENTS=y
CONFIG_KERNEL_NET_NF_CONNTRACK_FTP=y
CONFIG_KERNEL_NET_NF_CONNTRACK_H323=y
CONFIG_KERNEL_NET_NF_CONNTRACK_MSNMP=y
CONFIG_KERNEL_NET_NF_CONNTRACK_SIP=y
CONFIG_KERNEL_NET_NF_CONNTRACK_TFTP=y
CONFIG_KERNEL_NETFILTER_NETLINK_GLUE_CT=y
CONFIG_PACKAGE_kmod-fast-classifier=y  # 快速分类器
CONFIG_PACKAGE_kmod-flow-offload=y  # 流量硬卸载
CONFIG_PACKAGE_kmod-nft-flow=y       # NFT 流加速

# 2. TCP/网络栈优化
CONFIG_KERNEL_TCP_FASTOPEN=y  # TCP 快速打开
CONFIG_KERNEL_TCP_TIMESTAMPS=y
CONFIG_KERNEL_TCP_SACK=y
CONFIG_KERNEL_TCP_DSACK=y
CONFIG_KERNEL_TCP_MD5SIG=y
CONFIG_KERNEL_NET_IPIP=y
CONFIG_KERNEL_NET_IPGRE=y
CONFIG_KERNEL_NET_UDP_TUNNEL=y

# 3. 缓存/连接数优化
CONFIG_KERNEL_NET_IPV4_TCP_MEM=y
CONFIG_KERNEL_NET_IPV4_TCP_WMEM=y
CONFIG_KERNEL_NET_IPV4_TCP_RMEM=y
CONFIG_KERNEL_SYSCTL=y  # 支持 sysctl 永久配置

# 网络核心（硬件 NAT/WiFi 6）
CONFIG_PACKAGE_kmod-mt7981-firmware=y
CONFIG_PACKAGE_kmod-mt7603e=y
CONFIG_PACKAGE_kmod-mt7622-firmware=y
CONFIG_PACKAGE_kmod-mt7915e=y
CONFIG_PACKAGE_kmod-nft-offload=y
CONFIG_PACKAGE_nftables-json=y
CONFIG_PACKAGE_firewall4=nftables

# 基础工具 + 常用功能
CONFIG_PACKAGE_dnsmasq_full=y
CONFIG_PACKAGE_odhcp6c=y
CONFIG_PACKAGE_odhcpd-ipv6only=y
CONFIG_PACKAGE_opkg=y
CONFIG_PACKAGE_wireless-regdb=y
CONFIG_PACKAGE_iw=y
CONFIG_PACKAGE_wpa_supplicant=y
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-app-firewall=y
CONFIG_PACKAGE_luci-app-opkg=y
CONFIG_PACKAGE_luci-app-wifi-config=y
CONFIG_PACKAGE_luci-app-ddns=y
CONFIG_PACKAGE_luci-app-sqm=y  # 配合 BBR V3 优化队列
CONFIG_PACKAGE_luci-proto-pppoe=y

# 低功耗 + 无用功能关闭
CONFIG_PACKAGE_kmod-usb-ohci=y
CONFIG_PACKAGE_kmod-usb-uhci=y
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb3=n
CONFIG_PACKAGE_luci-app-wol=n
CONFIG_PACKAGE_luci-app-upnp=n
CONFIG_PACKAGE_luci-app-accesscontrol=n

# 调试/工具
CONFIG_PACKAGE_iputils-ping=y
CONFIG_PACKAGE_tcpdump=y
CONFIG_PACKAGE_sshd=y
CONFIG_PACKAGE_zram-swap=y
